# URL
https://developer.hashicorp.com/terraform/tutorials/aws-get-started/infrastructure-as-code

---

# IaC とは？
- Infrastructure as Code の略
- GUIではなく設定ファイルでインフラストラクチャを管理する
- IaC の利点は、インフラストラクチャのバージョン管理、再利用、共有が可能になることで、安全で一貫性のある反復可能な方法で構築、変更、管理できるようになること

# Terraform とは？
- Terraform は HashiCorp の IaC ツール
- Terraformは、人間が読める宣言的な設定ファイルでリソースとインフラストラクチャを定義し、インフラストラクチャのライフサイクルを管理する
- 手作業での管理と比較した際の、Terraform の利点は以下の4点
  - 複数のクラウドプラットフォーム上のインフラを管理できる
  - 人間が読める設定言語によって、インフラストラクチャのコードを素早く書くことができる
  - Terraformのステートによって、デプロイメント全体を通してリソースの変更を追跡できる
  - 設定をバージョン管理にコミットすることで、インフラストラクチャの共同作業を安全に行うことができる

## 補足: 複数のクラウドプラットフォーム上のインフラを管理できる
- プロバイダと呼ばれるTerraformプラグインによって、TerraformはAPIを介してクラウドプラットフォームやその他のサービスとやり取りすることができる
  - 例: AWS、Azure、GCP
- プロバイダは Terraform Registry から見つけることができる

> https://registry.terraform.io/browse/providers?product_intent=terraform

## 補足: 人間が読める設定言語
- プロバイダは、例えばコンピュートインスタンスやプライベートネットワークなど、インフラの個々の単位をリソースとして定義する
- 異なるプロバイダからのリソースをモジュールと呼ばれる再利用可能な Terraform のコンフィギュレーションにまとめ、一貫した言語とワークフローで管理することができる
- Terraform はインフラストラクチャの望ましい最終的な状態を記述する(=宣言型)
- Terraform プロバイダはリソース間の依存関係を自動的に計算し、正しい順序でリソースを作成または破棄する
- Terraform でインフラをデプロイするフロー
  - Scope - プロジェクトのインフラを特定する
  - Author - インフラの設定を書く
  - Initialize - インフラを管理するために必要なプラグインをインストールする
  - Plan - 設定に合わせてTerraformが行う変更をプレビューする
  - Apply - 計画した変更を実行する

## 補足: Terraformのステート
- Terraform は実際のインフラストラクチャの状態をステートファイルに記録している
- Terraformはこのステートファイルを使って、インフラストラクチャに加える変更を決定し、それが設定ファイルと一致するようにする

## インフラストラクチャの共同作業を安全に行う
- リモートステートファイルを利用してインフラストラクチャのコラボレーションを可能にする

### Terraform Cloud
- Terraform Cloud とは、チームメイトと安全に状態を共有し、Terraformの実行に安定した環境を提供してくれるサービス
- Terraform Cloud を使うことで、チームメイトと安全に状態を共有し、Terraformの実行に安定した環境を提供し、複数の人が同時に設定を変更した際の競合状態を防ぐことができる
- Terraform Cloud を バージョン管理システムに接続することで、アプリケーションコードと同じように、バージョン管理を通してインフラの変更を管理することができる
